<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bower_components/iron-form-element-behavior/iron-form-element-behavior.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="bridge-player-name.html">
<link rel="import" href="my-icons.html">

<dom-module is="bridge-input-player">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <style is="custom-style" include="iron-flex iron-flex-factors iron-flex-alignment"></style>

    <template is="dom-repeat" items="{{value}}">
      <div class="layout horizontal warp center">
        <span class="flex-1">Player [[_dispIndex(index)]] name:</span>
        <paper-input class="flex-5" label="Player [[_dispIndex(index)]] name" no-label-float value={{item}}></paper-input>
        <!-- Index value in the following button is a hack to pass through index to event handler -->
        <paper-icon-button icon="delete" alt="Delete" index="[[index]]" on-click="_rm"></paper-icon-button>
      </div>
    </template>

    <paper-icon-button icon="add" alt="Add player" id="add"></paper-icon-button>

  </template>

  <script>
    ((Polymer) => {
      'use strict';

      Polymer({
        is: 'bridge-input-player',
        behaviours: [Polymer.IronFormElementBehavior],

        properties: {
          name: {
            type: String,
            readOnly: true,
            value: 'bridge-input-player'
          },
          value: {
            type: Array,
            notify: true,
            value() {
              return [Bridge.randomName(), Bridge.randomName(), Bridge.randomName(), Bridge.randomName()]
            }
          }
        },

        listeners: {
          'add.click': '_mkPlayer'
        },

        _dispIndex(i) {
          return i+1;
        },

        _rm(event) {
          this.splice('value', event.target.index, 1);
        },

        _mkPlayer() {
          this.push('value', Bridge.randomName());
        }

      });

    })(Polymer);
  </script>
</dom-module>
